Next3 INSTALL:
==============

This INSTALL file contains instructions for building and installing next3 kernel module and utils.

The installer was tested on Ubuntu 9.10-10.10 distributions and on x86 and x86_64 machines,
but should work on any distribution with kernel version between 2.6.31 and 2.6.35 and on any machine.

Support for other kernel versions will be provided later on or per demand.

1. Download and build next3 kernel module and utils
===================================================
Download the next3 package from [http://sourceforge.net/projects/next3/files/].

The next3 kernel module has to match the kernel version on your system,
so the next3 Makefile detects your kernel version and tries to download
matching patches from the next3 website.

Pre-compiled binaries (for x86) of the patched e2fsprogs utils are included in the next3 package.
If those binaries fail to execute, the Makefile will build the utils for your system.

To build the next3 kernel module and optionally the next3 utils, run:

# tar xfz next3-1.0.12.tar.gz
# cd next3-1.0.12
# make
downloading next3 patches for kernel 2.6.29.3...
...
make -C /lib/modules/2.6.29.3/build M=/home/amir/next3-1.0.12/next3 modules
...
  LD [M]  /home/amir/next3-1.0.12/next3/next3.ko
make[1]: Leaving directory `/usr/src/kernels/linux-2.6.29.3'
bin/mkfs.next3 -V || make e2fsprogs
mke2fs 1.41.9-next3-1.0.12 (25-Jul-2010)
        Using EXT2FS Library version 1.41.9-next3-1.0.12
bin/fsck.next3 -V
e2fsck 1.41.9-next3-1.0.12 (25-Jul-2010)
        Using EXT2FS Library version 1.41.9-next3-1.0.12, 25-Jul-2010


2. Test next3 snapshots
=======================
At this point, you can test the next3 filesystem without installing the module and utils on your system.
To create a next3 filesystem on an image file and test snapshots, run:

# sudo make test
grep next3 /proc/modules || /sbin/insmod next3/next3.ko
(test -f test.img && (bin/tunefs.next3 -l test.img | grep UUID)) || ( touch test.img ; yes | bin/mkfs.next3 test.img 1048576 )
mke2fs 1.41.9-next3-1.0.12 (25-Jul-2010)
...
Running snapshot test 1:
------------------------
...


3. Install next3 kernel module and utils on your system
=======================================================
# sudo make install
mkdir -p /lib/modules/2.6.29.3/fs/next3
install -m 644 next3/next3.ko /lib/modules/2.6.29.3/fs/next3
/sbin/depmod -a
/sbin/modprobe next3
install bin/next3 /sbin
install bin/fsck.next3 /sbin
install bin/mkfs.next3 /sbin
install bin/tunefs.next3 /sbin
install bin/lsattr.next3 /sbin
install bin/chattr.next3 /sbin


see HOWTO file for some usage examples of working with next3 snapshot.
